<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Moon Phase Tracker</title>
  <style>
    :root{
      --bg:#0b0c10; --card:#15161a; --text:#eaeaea; --muted:#a8b3cf; --accent:#ffd369;
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:24px; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 700px at 50% -10%, #182036, #10131f 40%, var(--bg) 70%); color:var(--text);
    }
    h1{margin:0 0 6px; text-align:center; font-size:clamp(1.6rem, 2.8vw, 2.2rem)}
    .sub{color:var(--muted); text-align:center; margin-bottom:22px}
    .wrap{max-width:980px; margin:0 auto}
    .cards{
      display:grid; gap:16px; grid-template-columns:repeat(auto-fit, minmax(230px,1fr));
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px; padding:18px; text-align:center;
      box-shadow:0 8px 30px rgba(0,0,0,.35);
    }
    .card.today{ border-color:rgba(255,211,105,.55); box-shadow:0 10px 40px rgba(255,211,105,.18);}
    .date{color:var(--accent); font-weight:700; margin-bottom:8px}
    .label{margin-top:8px; font-weight:600}
    .muted{color:var(--muted); font-size:.9rem}
    .svgwrap{width:120px; height:120px; margin:10px auto}
    .btnrow{display:flex; justify-content:center; gap:12px; margin:22px 0}
    button{
      background:var(--accent); color:#1a1a1a; border:none; font-weight:700; cursor:pointer;
      padding:12px 18px; border-radius:10px; transition:.2s transform, .2s box-shadow;
    }
    button:hover{ transform:translateY(-1px); box-shadow:0 6px 20px rgba(255,211,105,.35);}
    button.secondary{ background:transparent; color:var(--text); border:1px solid rgba(255,255,255,.2); }
    .hidden{display:none}
    @media (max-width:520px){ .svgwrap{width:100px;height:100px} }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ðŸŒ™ Moon Phase Tracker</h1>
    <p class="sub">Todayâ€™s phase and the next 7 days â€” no internet images or APIs required.</p>

    <div id="today" class="cards"></div>

    <div class="btnrow">
      <button id="showNext">Show Next 7 Days</button>
      <button id="backToToday" class="secondary hidden">Back to Today</button>
    </div>

    <div id="next7" class="cards hidden"></div>
  </div>

  <script>
    // --- Moon phase core (approximate but reliable for UI purposes) ---
    // Uses a standard reference new moon: 2000-01-06 18:14 UTC
    const SYNODIC = 29.530588853;
    const REF = Date.UTC(2000,0,6,18,14,0);

    function phaseFraction(date){ // 0..1 (0 = New, 0.5 = Full)
      const dUTC = Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());
      let days = (dUTC - REF) / 86400000;
      days = ((days % SYNODIC) + SYNODIC) % SYNODIC;           // wrap to [0,SYNODIC)
      return days / SYNODIC;
    }

    function illuminationPercent(frac){ // rough illuminated fraction (%)
      return ((1 - Math.cos(2*Math.PI*frac)) / 2) * 100;
    }

    function phaseIndex(frac){ // 8 buckets, rounded to nearest
      return Math.round(frac * 8) % 8;
    }

    const PHASE_NAMES = [
      "New Moon","Waxing Crescent","First Quarter","Waxing Gibbous",
      "Full Moon","Waning Gibbous","Last Quarter","Waning Crescent"
    ];

    // --- Inline SVG icons (no external links) ---
    function svgFor(idx){
      // base colors
      const dark = "#1f2230";
      const light = "#f2f2f2";
      const stroke = "#0d0f17";
      const outline = `<circle cx="50" cy="50" r="46" fill="${dark}" stroke="${stroke}" stroke-width="2"/>`;

      // helpers
      const halfRight = `
        <defs><clipPath id="R"><rect x="50" y="4" width="46" height="92" rx="0"/></clipPath></defs>
        <circle cx="50" cy="50" r="46" fill="${light}" clip-path="url(#R)"/>
      `;
      const halfLeft = `
        <defs><clipPath id="L"><rect x="4" y="4" width="46" height="92" rx="0"/></clipPath></defs>
        <circle cx="50" cy="50" r="46" fill="${light}" clip-path="url(#L)"/>
      `;
      const crescentRight = `
        <defs>
          <clipPath id="Cbase"><circle cx="50" cy="50" r="46"/></clipPath>
        </defs>
        <g clip-path="url(#Cbase)">
          <circle cx="60" cy="50" r="46" fill="${light}"/>
        </g>
      `;
      const crescentLeft = `
        <defs>
          <clipPath id="Cbase2"><circle cx="50" cy="50" r="46"/></clipPath>
        </defs>
        <g clip-path="url(#Cbase2)">
          <circle cx="40" cy="50" r="46" fill="${light}"/>
        </g>
      `;
      const gibbousRight = `
        <defs>
          <clipPath id="Gbase"><circle cx="50" cy="50" r="46"/></clipPath>
        </defs>
        <g clip-path="url(#Gbase)">
          <circle cx="50" cy="50" r="46" fill="${light}"/>
          <circle cx="40" cy="50" r="46" fill="${dark}"/>
        </g>
      `;
      const gibbousLeft = `
        <defs>
          <clipPath id="Gbase2"><circle cx="50" cy="50" r="46"/></clipPath>
        </defs>
        <g clip-path="url(#Gbase2)">
          <circle cx="50" cy="50" r="46" fill="${light}"/>
          <circle cx="60" cy="50" r="46" fill="${dark}"/>
        </g>
      `;

      const svgs = [
        `${outline}`,                               // 0 New (dark)
        `${outline}${crescentRight}`,               // 1 Waxing Crescent
        `${outline}${halfRight}`,                   // 2 First Quarter
        `${outline}${gibbousRight}`,                // 3 Waxing Gibbous
        `<circle cx="50" cy="50" r="46" fill="${light}" stroke="${stroke}" stroke-width="2"/>`, // 4 Full
        `${outline}${gibbousLeft}`,                 // 5 Waning Gibbous
        `${outline}${halfLeft}`,                    // 6 Last Quarter
        `${outline}${crescentLeft}`                 // 7 Waning Crescent
      ];

      return `<svg viewBox="0 0 100 100" width="100%" height="100%" role="img" aria-label="${PHASE_NAMES[idx]} icon">${svgs[idx]}</svg>`;
    }

    // --- UI helpers ---
    function fmtDate(d){
      const today = new Date();
      const t0 = new Date(Date.UTC(today.getUTCFullYear(), today.getUTCMonth(), today.getUTCDate()));
      const d0 = new Date(Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate()));

      const diff = (d0 - t0)/86400000;
      if (diff === 0) return "Today";
      if (diff === 1) return "Tomorrow";
      return d.toLocaleDateString(undefined, { weekday:"short", month:"short", day:"numeric" });
    }

    function makeCard(date, isToday=false){
      const frac = phaseFraction(date);
      const idx = phaseIndex(frac);
      const illum = illuminationPercent(frac);
      return `
        <div class="card ${isToday ? 'today' : ''}">
          <div class="date">${fmtDate(date)}</div>
          <div class="svgwrap">${svgFor(idx)}</div>
          <div class="label">${PHASE_NAMES[idx]}</div>
          <div class="muted">Illumination: ${illum.toFixed(1)}%</div>
        </div>
      `;
    }

    function render(){
      const todayWrap = document.getElementById('today');
      const nextWrap  = document.getElementById('next7');
      const showBtn   = document.getElementById('showNext');
      const backBtn   = document.getElementById('backToToday');

      // Today
      const today = new Date();
      todayWrap.innerHTML = makeCard(today, true);

      // Next 7 (hidden until clicked)
      const cards = [];
      for (let i=1;i<=7;i++){
        const d = new Date();
        d.setDate(d.getDate()+i);
        cards.push(makeCard(d));
      }
      nextWrap.innerHTML = cards.join('');

      showBtn.onclick = () => {
        nextWrap.classList.remove('hidden');
        backBtn.classList.remove('hidden');
        showBtn.classList.add('hidden');
        // Scroll smoothly to the next section for phones
        nextWrap.scrollIntoView({behavior:"smooth", block:"start"});
      };
      backBtn.onclick = () => {
        nextWrap.classList.add('hidden');
        backBtn.classList.add('hidden');
        showBtn.classList.remove('hidden');
        window.scrollTo({top:0, behavior:"smooth"});
      };
    }

    render();
  </script>
</body>
</html>
